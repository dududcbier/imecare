package bd;

import java.sql.*;
import java.sql.PreparedStatement;

import modelo.Person;

	public class AddUserDao {
		
		private Connection conexao;
	 
		public AddUserDao() {
	     this.conexao = ConnectionFactory.obterInstancia().obterConexao();
	   }
		
		public void AddUser(Person person){
			String sql = "insert into pessoa "
					+ "(cpf,rg,	nome, dt_nascimento,parentesco)" + " values (?,?,?,?,?)";
			
			try {
				// prepared statement para inserção
				PreparedStatement stmt = conexao.prepareStatement(sql);

				// seta os valores

				stmt.setString(1, person.getCpf());
				stmt.setString(2, person.getRg());
				stmt.setString(3, person.getName());
				stmt.setDate(4, new Date(person.getBirthDate().getTimeInMillis()));
				stmt.setString(5, person.getParentesco());
				// executa
				stmt.execute();
				stmt.close();
			} catch (SQLException e) {
				// A SQLException é "encapsulada" em uma RuntimeException
				// para desacoplar o código da API de JDBC
				throw new RuntimeException(e);
			}	
			
			//addEmail(person);	
		}

	
	
	
}
