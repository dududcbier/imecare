package bd;

import java.sql.*;
import java.util.*;

import modelo.Possui;

public class PossuiDao {
	
	private Connection conexao;
	 
	public PossuiDao() {
		this.conexao = ConnectionFactory.obterInstancia().obterConexao();
	}

	public void addPossui(Possui possui){
		String sql = "insert into possui "
				+ "(cid, nome_sintoma)" + " values (?,?)";
		
		try {
			// prepared statement para inserção
			PreparedStatement stmt = conexao.prepareStatement(sql);
	
			// seta os valores
				stmt.setString(1, possui.getCid());
			stmt.setString(2, possui.getSymptonName());
			
			// executa
			stmt.execute();
			stmt.close();
		} catch (SQLException e) {
			throw new RuntimeException(e);
		}		
	}
	
	
	
	}

	public Possui getPossui(String cpf){

		try {
			Person person = null;
			
			PreparedStatement stmt = conexao.prepareStatement("select * "
					+ "from pessoa where cpf=?");
			stmt.setString(1, cpf);
			ResultSet rs = stmt.executeQuery();

			if (rs.next()) {
				person = new Person();

				person.setCpf(cpf);
				person.setName(rs.getString("nome"));
				person.setAddress(rs.getString("endereco"));
				person.setEmail(rs.getString("email"));
				person.setParentesco(rs.getString("parentesco"));

				Calendar date = Calendar.getInstance();
				date.setTime(rs.getDate("dt_nascimento"));
				person.setBirthDate(date);

			}
			rs.close();
			stmt.close();
			return person;

		} catch (SQLException e) {
			throw new RuntimeException(e);
		}
	}
	
		
	public void removerPossui(Possui possui) {
		try {
			PreparedStatement stmt = conexao.prepareStatement("delete "
					+ "from pessoa where cid=? AND nome_sintoma=?");
			stmt.setString(1, possui.getCid());
			stmt.setString(1, possui.getSymptonName());
			stmt.execute();
			stmt.close();
		} catch (SQLException e) {
			throw new RuntimeException(e);
		}

		// removeEmail(person);
	}
	
	
	
	
	
}